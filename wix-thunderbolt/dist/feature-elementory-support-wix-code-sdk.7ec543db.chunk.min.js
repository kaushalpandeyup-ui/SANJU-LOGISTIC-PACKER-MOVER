"use strict";(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[8890],{16821:(e,t,r)=>{t.iu=t.lK=void 0;var o=r(24091);Object.defineProperty(t,"iu",{enumerable:!0,get:function(){return o.deserialize}});var n=r(68534);Object.defineProperty(t,"lK",{enumerable:!0,get:function(){return n.serialize}})},24091:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeResult=t.deserialize=void 0;var o=r(99676),n=function(e){return function(e){return!!(null==e?void 0:e._elementoryError)}(e)?function(e){var t=new Error(e.message);return t.stack=e.stack,t.name=e.name,t.code=e.code,t}(e):e};t.deserializeResult=n;t.deserialize=function(e){var t=(0,o.convertFromCustomFormat)(JSON.parse(e)),r=t.result;return{isError:!!t.exception,payload:n(r)}}},68534:function(e,t,r){var o=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=void 0;var n=r(99676);t.serialize=function(e){return JSON.stringify((0,n.convertToCustomFormat)(o([],e,!0)))}},99676:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBackendPackageNameFromImportName=t.generateBackendPackageWebMethodUrl=t.generatePackageWebMethodUrl=t.exceptionToWebMethodPayload=t.resultToWebMethodPayload=t.convertFromCustomFormat=t.convertToCustomFormat=void 0;var o=r(29587);Object.defineProperty(t,"convertToCustomFormat",{enumerable:!0,get:function(){return o.convertToCustomFormat}}),Object.defineProperty(t,"convertFromCustomFormat",{enumerable:!0,get:function(){return o.convertFromCustomFormat}});var n=r(21298);Object.defineProperty(t,"resultToWebMethodPayload",{enumerable:!0,get:function(){return n.resultToWebMethodPayload}}),Object.defineProperty(t,"exceptionToWebMethodPayload",{enumerable:!0,get:function(){return n.exceptionToWebMethodPayload}}),Object.defineProperty(t,"generatePackageWebMethodUrl",{enumerable:!0,get:function(){return n.generatePackageWebMethodUrl}}),Object.defineProperty(t,"generateBackendPackageWebMethodUrl",{enumerable:!0,get:function(){return n.generateBackendPackageWebMethodUrl}}),Object.defineProperty(t,"getBackendPackageNameFromImportName",{enumerable:!0,get:function(){return n.getBackendPackageNameFromImportName}})},88360:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ConvertersComposer=void 0;var o=r(46289),n=function(e){return null!==e&&"object"==typeof e},a=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._converters=e}return e.prototype.convertToCustomFormat=function(e,t,r){var o;if(void 0===t&&(t=new Set),void 0===r&&(r=!1),n(e)){if(t.has(e))throw new TypeError("Converting circular structure to JSON");t.add(e)}if(Array.isArray(e))return this._convertArray(e,t);var a=null===(o=this._findConverterToCustomFormat(e))||void 0===o?void 0:o.convertToCustomFormat(e,r);return n(e)?this._convertObject(a,e,t):a},e.prototype.convertFromCustomFormat=function(e){var t,r=this,a=e;return Array.isArray(e)?a=e.map(function(e){return r.convertFromCustomFormat(e)}):n(e)&&(a=(0,o.mapValues)(e,this.convertFromCustomFormat.bind(this))),null===(t=this._findConverterFromCustomFormat(a))||void 0===t?void 0:t.convertFromCustomFormat(a)},e.prototype._convertObject=function(e,t,r){var n,a=this;return n="function"==typeof e.toJSON?(0,o.mapValues)(e.toJSON(),function(e){return a.convertToCustomFormat(e,r)}):(0,o.mapValues)(e,function(e){return a.convertToCustomFormat(e,r)}),r.delete(t),n},e.prototype._convertArray=function(e,t){var r=this,o=e.map(function(e){return r.convertToCustomFormat(e,t,!0)});return t.delete(e),o},e.prototype._findConverterFromCustomFormat=function(e){return this._converters.find(function(t){return t.canConvertFromCustomFormat(e)})},e.prototype._findConverterToCustomFormat=function(e){return this._converters.find(function(t){return t.canConvertToCustomFormat(e)})},e}();t.ConvertersComposer=a},18815:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DateConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(e){return e instanceof Date},e.prototype.convertToCustomFormat=function(e){return{$date:e.toISOString()}},e.prototype.canConvertFromCustomFormat=function(e){return this._isObjectWith$Date(e)&&"string"==typeof e.$date&&(t=e.$date,!Number.isNaN(Date.parse(t)));var t},e.prototype.convertFromCustomFormat=function(e){return new Date(e.$date)},e.prototype._isObjectWith$Date=function(e){return!!e&&"object"==typeof e&&"$date"in e},e}();t.DateConverter=r},76500:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultConverter=void 0;var r=function(){function e(){}return e.prototype.canConvertToCustomFormat=function(){return!0},e.prototype.convertToCustomFormat=function(e,t){return t&&void 0===e?null:e},e.prototype.canConvertFromCustomFormat=function(){return!0},e.prototype.convertFromCustomFormat=function(e){return e},e}();t.DefaultConverter=r},29587:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertFromCustomFormat=t.convertToCustomFormat=void 0;var o=r(88360),n=r(18815),a=r(76500),i=new o.ConvertersComposer(new n.DateConverter,new a.DefaultConverter);t.convertToCustomFormat=function(e){return i.convertToCustomFormat(e)};t.convertFromCustomFormat=function(e){return i.convertFromCustomFormat(e)}},46289:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapValues=void 0,t.mapValues=function(e,t){var r={};return Object.keys(e).forEach(function(o){var n=t(e[o]);void 0!==n&&(r[o]=n)}),r}},21298:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBackendPackageNameFromImportName=t.generateBackendPackageWebMethodUrl=t.generatePackageWebMethodUrl=t.exceptionToWebMethodPayload=t.resultToWebMethodPayload=void 0;var o=r(29587);t.resultToWebMethodPayload=function(e,t){var r=t?JSON.parse(JSON.stringify(e,t)):(0,o.convertToCustomFormat)(e);return void 0===r?{}:{result:r}};t.exceptionToWebMethodPayload=function(e,t,r){return void 0===t&&(t=function(e){return e}),void 0===r&&(r=function(e){return""}),{result:e instanceof Error?{message:t(e.message),name:e.name,stack:r(e.stack),code:e.code,_elementoryError:!0}:e,exception:!0}};var n=function(e,t){return"/_webMethods/packages/".concat(encodeURIComponent(e),"/").concat(t,".ajax")};t.generatePackageWebMethodUrl=n;t.generateBackendPackageWebMethodUrl=function(e,t){return n("".concat(e,"-backend"),t)};t.getBackendPackageNameFromImportName=function(e){return"".concat(e,"-backend")}},66700:(e,t,r)=>{r.d(t,{ElementorySupportSdkFactory:()=>l});const o="elementorySupport";var n=r(16821);const a={PARSE:"parsererror",ERROR:"error",ABORT:"abort",TIMEOUT:"timeout"};class i extends Error{constructor(e,t){super(t),this.errorType=e}}const c="Request timed out",u="Promise in backend function rejected with undefined";const s=6e4,m=async(e,t,r,o,n,a)=>{let i;if(n&&a?.cache?.tags.length){const n=((e,t,r)=>{const o=t.join(" ");return`${e?`&serializedArgs=${encodeURIComponent(e)}`:""}${r?`&ttl=${r}`:""}&tags=${encodeURIComponent(o)}`})(t,a.cache.tags,a.cache.ttl);i=await o.get(`${e}${n}`,{headers:{...r,"x-vcache-req":"true"}})}else i=await o.post(e,t,{headers:r});return i},d=(e,t,r,o,d,l,p,v,f)=>({baseUrl:e,getQueryParameters:t,getRequestOptions:r,errorTypes:a,logger:f,setHeader:l,async getJSON(l,y=[],g=null,b=null){f.interactionStarted("elementory_support_get_json");const h=t(),C=r(),F=function(e,t,r,o,n){const a=o?(e=>e.startsWith("//")?e.substring(1):e)(n):e;if(!r)return a+t;const i=(e=>e.startsWith("?")||e.startsWith("&")?e.substring(1):e)(r);return-1===t.indexOf("?")?`${a}${t}?${i}`:`${a}${t}&${i}`}(e,l,h,v,p),{headers:P={},timeout:_=s}=C,T={...P,...g&&{Authorization:d.getInstance(g)},"Content-Type":"application/json"},O=(e,t="")=>new i(e,t);return new Promise(async(e,t)=>{const r=setTimeout(()=>{t(O(a.TIMEOUT,c))},_);try{const i=(0,n.lK)(y),c=await m(F,i,T,o,v,b);clearTimeout(r);try{const r=(0,n.iu)(JSON.stringify(c.data));f.interactionEnded("elementory_support_get_json");const{isError:o,payload:a}=r;if(o){const e=a||new Error(u);t(e)}else e(a)}catch(e){t(O(a.PARSE,e.message))}}catch(e){t(O(a.ERROR,e.message))}})}}),l=({featureConfig:e,platformUtils:{sessionService:t},appEssentials:{httpClient:r},platformEnvData:{window:{csrfToken:n},site:a,mainGridAppId:i,session:c},appDefinitionId:u,blocksAppsUtils:s,logger:m})=>{function l(){const{isRunningInDifferentSiteContext:e}=c,r=t.getInstance(u),o=s.isBlocksApp(u);return s.isFixWixDataInstanceForBlocksPreviewExperimentOpen()&&e||o&&s.canAppInstanceBeUsedForAuthorization(r)?r:t.getWixCodeInstance()}const{viewMode:p,baseUrl:v,relativePath:f,gridAppId:y,siteRevision:g}=e,b="site"===p,h={},C=i||y,F=b&&Boolean(a.experiments["specs.thunderbolt.excludeInstanceFromQueryParams"])?"":l();return{[o]:d(v,()=>((e,t,r)=>{const o=`?gridAppId=${e}&viewMode=${t}`;return r?`${o}&instance=${r}`:o})(C,p,F),()=>({headers:{"X-XSRF-TOKEN":n,"x-wix-site-revision":g.toString(),"x-wix-app-instance":t.getInstance(u),Authorization:l(),...h}}),r,t,(e,t)=>{h[e]=t},f,b,m)}}}}]);
//# sourceMappingURL=feature-elementory-support-wix-code-sdk.7ec543db.chunk.min.js.map